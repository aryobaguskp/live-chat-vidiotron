<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Live Chat Café – Videotron</title>
<script src="/socket.io/socket.io.js"></script>

<style>
/* ===== RESET ===== */
*{box-sizing:border-box}

/* ===== BACKGROUND LAYER ===== */
#bg{
  position:fixed;
  inset:0;
  background:url("bg cafe.png") center/cover no-repeat;
  z-index:-2;
}
#overlay{
  position:fixed;
  inset:0;
  background:black;
  opacity:.55;
  z-index:-1;
  transition:opacity .3s ease;
}

/* ===== GLOBAL ===== */
body{
  margin:0;
  height:100vh;
  background:
    radial-gradient(circle at top,#1e1e1e 0%,#000 60%);
  color:#fff;
  font-family:"Segoe UI",Arial,sans-serif;
  overflow:hidden;
}

/* ===== HEADER ===== */
#header{
  position:absolute;
  top:30px;
  left:50px;
  right:50px;
  display:flex;
  align-items:center;
  gap:20px;
}
#header img{
  height:clamp(40px, 6vh, 80px);
}
#header h1{
  margin:0;
  font-size:clamp(26px, 3.5vw, 56px);
  letter-spacing:3px;
  font-weight:700;
  text-shadow:0 0 15px rgba(255,210,125,.35);
}
#header span{
  font-size:16px;
  opacity:.7;
}

/* ===== DIVIDER LINE ===== */
#divider{
  position:absolute;
  top:120px;
  left:50px;
  right:50px;
  height:1px;
  background:linear-gradient(
    to right,
    transparent,
    #ffd27d,
    transparent
  );
  opacity:.6;
}

/* ===== CHAT AREA ===== */
#messages{
 position:absolute;
  left:5vw;
  right:5vw;
  bottom:6vh;
  max-height:60vh;
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  pointer-events:none;
  transition:all .4s ease;
}


/* ===== MESSAGE ===== */
.msg{
  margin-top:22px;
  font-size:clamp(22px, 2.8vw, 38px);
  line-height:1.35;
  animation:slideUp .6s ease-out;
}
.msg b{
  color:#ffd27d;
  font-weight:700;
  text-shadow:0 0 12px rgba(255,210,125,.45);
}

/* ===== ANIMATION ===== */
@keyframes slideUp{
  from{
    transform:translateY(35px);
    opacity:0;
  }
  to{
    transform:translateY(0);
    opacity:1;
  }
}

/* ===== FOOTER ===== */
#footer{
  position:absolute;
  bottom:18px;
  left:60px;
  right:60px;
  display:flex;
  justify-content:space-between;
  font-size:clamp(12px, 1.2vw, 16px);
  opacity:.45;
}
#footer span:last-child{
  font-weight:500;
}
</style>
</head>

<body>

<div id="bg"></div>
<div id="overlay"></div>


<!-- HEADER -->
<div id="header">
  <img src="logo.png" alt="Logo Café">
  <div>
    <h1>LIVE CHAT MERCI CAFE</h1>
    <span>Coba keseruan baru yukkkk</span>
  </div>
</div>

<div id="divider"></div>

<!-- CHAT -->
<div id="messages"></div>

<!-- FOOTER -->
<div id="footer">
  <span>Powered by Live Chat Merci Cafe</span>
  <span id="clock"></span>
</div>

<script>
const socket = io();
const box = document.getElementById("messages");
const clock = document.getElementById("clock");
const MAX_MESSAGES = 8;
const overlay = document.getElementById("overlay");

socket.on("display-bg-opacity",(val)=>{
  overlay.style.opacity = val;
});


/* ===== JAM REALTIME ===== */
setInterval(()=>{
  const d=new Date();
  clock.innerText =
    d.getHours().toString().padStart(2,"0")+":"+
    d.getMinutes().toString().padStart(2,"0");
},1000);

/* ===== RENDER AWAL ===== */
socket.on("refresh-messages",(msgs)=>{
  box.innerHTML="";
  msgs.slice(-MAX_MESSAGES).forEach(addMessage);
});

/* ===== PESAN BARU ===== */
socket.on("new-message",(msg)=>{
  addMessage(msg);
});

/* ===== TAMBAH PESAN ===== */
function addMessage(msg){
  const div=document.createElement("div");
  div.className="msg";
  div.innerHTML=`<b>${msg.username}</b>: ${msg.message}`;
  box.appendChild(div);

  if(box.children.length > MAX_MESSAGES){
    box.removeChild(box.children[0]);
  }
}

socket.on("chat-layout",(mode)=>{
  document.body.className = "chat-" + mode;
});

</script>

</body>
</html>
