<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Live Chat Caf√©</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body{margin:0;background:black;color:white;font-family:Arial}
#messages{position:absolute;bottom:40px;left:40px;right:40px}
.msg{margin-top:18px;font-size:28px}
.msg b{color:#ffd27d}
</style>
</head>

<body>

<div id="messages"></div>

<script>
const socket = io();
const box = document.getElementById("messages");
const MAX = 12;

socket.on("refresh-messages",(msgs)=>{
  box.innerHTML="";
  msgs.slice(-MAX).forEach(addMessage);
});

socket.on("new-message",(msg)=>{
  addMessage(msg);
});

socket.on("display-refresh",(msgs)=>{
  box.innerHTML="";
  msgs.slice(-MAX).forEach(addMessage);
});

function addMessage(msg){
  const d=document.createElement("div");
  d.className="msg";
  d.innerHTML=`<b>${msg.username}</b>: ${msg.message}`;
  box.appendChild(d);
  if(box.children.length>MAX){
    box.removeChild(box.children[0]);
  }
}
</script>

</body>
</html>
